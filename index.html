<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proxy & VPN Detection Tool</title>
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2980b9;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --card: #ffffff;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            margin-bottom: 30px;
            text-align: center;
        }
        
        h1 {
            color: var(--dark);
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.1rem;
        }
        
        .input-section {
            background-color: var(--card);
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--dark);
        }
        
        input[type="text"] {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 12px 20px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: var(--secondary);
        }
        
        .results-section {
            display: none;
            background-color: var(--card);
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .ip-info {
            font-size: 1.2rem;
        }
        
        .status-indicator {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: bold;
            text-align: center;
            min-width: 120px;
        }
        
        .status-clean {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-suspicious {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .status-proxy {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            margin-right: 5px;
            border-radius: 4px 4px 0 0;
        }
        
        .tab.active {
            background-color: var(--primary);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .score-container {
            margin: 20px 0;
            text-align: center;
        }
        
        .score-gauge {
            position: relative;
            width: 200px;
            height: 100px;
            margin: 0 auto;
            overflow: hidden;
        }
        
        .gauge-background {
            width: 200px;
            height: 100px;
            border-radius: 100px 100px 0 0;
            background: #eee;
        }
        
        .gauge-fill {
            position: absolute;
            top: 0;
            left: 0;
            width: 200px;
            height: 100px;
            border-radius: 100px 100px 0 0;
            background: linear-gradient(90deg, var(--success), var(--warning), var(--danger));
            transform-origin: bottom center;
        }
        
        .gauge-cover {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 180px;
            height: 90px;
            border-radius: 90px 90px 0 0;
            background: white;
        }
        
        .gauge-value {
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
        }
        
        .detail-card {
            background-color: #f8f9fa;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .detail-card h3 {
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        .detail-list {
            list-style: none;
        }
        
        .detail-list li {
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
        }
        
        .detail-label {
            font-weight: 500;
        }
        
        .detail-value {
            text-align: right;
        }
        
        .flag-true {
            color: var(--danger);
        }
        
        .flag-false {
            color: var(--success);
        }
        
        .map-container {
            height: 300px;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        table th, table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            color: #666;
            font-size: 0.9rem;
        }

        .recommendation-box {
            margin-top: 20px;
            padding: 15px;
            border-radius: 4px;
            text-align: center;
        }

        .recommendation-allow {
            background-color: #d4edda;
            color: #155724;
        }

        .recommendation-monitor {
            background-color: #d1ecf1;
            color: #0c5460;
        }

        .recommendation-challenge {
            background-color: #fff3cd;
            color: #856404;
        }

        .recommendation-block {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .results-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .status-indicator {
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Proxy & VPN Detection Tool</h1>
            <p class="subtitle">Analyze and detect if an IP address is using a proxy, VPN, or anonymization service</p>
        </header>
        
        <section class="input-section">
            <div class="form-group">
                <label for="ipAddress">Enter IP Address</label>
                <input type="text" id="ipAddress" placeholder="e.g., 174.113.207.105" value="174.113.207.105">
            </div>
            
            <div class="form-group">
                <button id="analyzeBtn">Analyze IP</button>
            </div>
        </section>
        
        <section id="resultsSection" class="results-section">
            <div class="results-header">
                <div class="ip-info">
                    IP: <strong id="ipDisplay">174.113.207.105</strong>
                    <span id="countryDisplay">ðŸ‡¨ðŸ‡¦ Canada</span>
                </div>
                <div id="statusIndicator" class="status-indicator">Loading...</div>
            </div>
            
            <div class="score-container">
                <h2>Suspicion Score</h2>
                <div class="score-gauge">
                    <div class="gauge-background"></div>
                    <div id="gaugeFill" class="gauge-fill"></div>
                    <div class="gauge-cover"></div>
                    <div id="gaugeValue" class="gauge-value">0</div>
                </div>
                <div id="recommendationBox" class="recommendation-box">
                    Analyzing...
                </div>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="summary">Summary</div>
                <div class="tab" data-tab="details">Detailed Analysis</div>
                <div class="tab" data-tab="location">Location</div>
                <div class="tab" data-tab="raw">Raw Data</div>
            </div>
            
            <div id="summaryTab" class="tab-content active">
                <div class="detail-card">
                    <h3>Quick Overview</h3>
                    <ul class="detail-list">
                        <li>
                            <span class="detail-label">IP Address</span>
                            <span id="summaryIp" class="detail-value">174.113.207.105</span>
                        </li>
                        <li>
                            <span class="detail-label">Country</span>
                            <span id="summaryCountry" class="detail-value">Canada</span>
                        </li>
                        <li>
                            <span class="detail-label">City</span>
                            <span id="summaryCity" class="detail-value">Saint John</span>
                        </li>
                        <li>
                            <span class="detail-label">ISP</span>
                            <span id="summaryIsp" class="detail-value">Rogers Communications Canada Inc.</span>
                        </li>
                        <li>
                            <span class="detail-label">Proxy Detection</span>
                            <span id="summaryProxy" class="detail-value flag-false">Not Detected</span>
                        </li>
                        <li>
                            <span class="detail-label">VPN Detection</span>
                            <span id="summaryVpn" class="detail-value flag-false">Not Detected</span>
                        </li>
                        <li>
                            <span class="detail-label">Tor Detection</span>
                            <span id="summaryTor" class="detail-value flag-false">Not Detected</span>
                        </li>
                        <li>
                            <span class="detail-label">Detection Confidence</span>
                            <span id="summaryConfidence" class="detail-value">85%</span>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div id="detailsTab" class="tab-content">
                <div class="detail-card">
                    <h3>Direct Security Flags</h3>
                    <ul class="detail-list">
                        <li>
                            <span class="detail-label">Explicit Proxy</span>
                            <span id="detailExplicitProxy" class="detail-value flag-false">False</span>
                        </li>
                        <li>
                            <span class="detail-label">Proxy Type</span>
                            <span id="detailProxyType" class="detail-value">None</span>
                        </li>
                        <li>
                            <span class="detail-label">Tor Exit Node</span>
                            <span id="detailTor" class="detail-value flag-false">False</span>
                        </li>
                        <li>
                            <span class="detail-label">Craweler/Bot</span>
                            <span id="detailCrawler" class="detail-value flag-false">False</span>
                        </li>
                        <li>
                            <span class="detail-label">Threat Level</span>
                            <span id="detailThreatLevel" class="detail-value">Low</span>
                        </li>
                    </ul>
                </div>
                
                <div class="detail-card">
                    <h3>IP Reputation Analysis</h3>
                    <ul class="detail-list">
                        <li>
                            <span class="detail-label">Fraud Score</span>
                            <span id="detailFraudScore" class="detail-value">25/100</span>
                        </li>
                        <li>
                            <span class="detail-label">Proxy Detection</span>
                            <span id="detailReputationProxy" class="detail-value flag-false">False</span>
                        </li>
                        <li>
                            <span class="detail-label">VPN Detection</span>
                            <span id="detailReputationVpn" class="detail-value flag-false">False</span>
                        </li>
                        <li>
                            <span class="detail-label">Tor Detection</span>
                            <span id="detailReputationTor" class="detail-value flag-false">False</span>
                        </li>
                        <li>
                            <span class="detail-label">Bot Status</span>
                            <span id="detailReputationBot" class="detail-value flag-false">False</span>
                        </li>
                    </ul>
                </div>
                
                <div class="detail-card">
                    <h3>ASN & ISP Analysis</h3>
                    <ul class="detail-list">
                        <li>
                            <span class="detail-label">ASN</span>
                            <span id="detailAsn" class="detail-value">812</span>
                        </li>
                        <li>
                            <span class="detail-label">ISP</span>
                            <span id="detailIsp" class="detail-value">Rogers Communications Canada Inc.</span>
                        </li>
                        <li>
                            <span class="detail-label">Known Proxy/VPN ASN</span>
                            <span id="detailKnownAsn" class="detail-value flag-false">False</span>
                        </li>
                        <li>
                            <span class="detail-label">VPN/Proxy Keywords in ISP</span>
                            <span id="detailIspKeywords" class="detail-value flag-false">False</span>
                        </li>
                    </ul>
                </div>
                
                <div class="detail-card">
                    <h3>Geographic Consistency</h3>
                    <ul class="detail-list">
                        <li>
                            <span class="detail-label">Time Zone Matches Region</span>
                            <span id="detailTimeZoneMatch" class="detail-value flag-true">True</span>
                        </li>
                        <li>
                            <span class="detail-label">Has Detailed Location</span>
                            <span id="detailDetailedLocation" class="detail-value flag-true">True</span>
                        </li>
                        <li>
                            <span class="detail-label">Region</span>
                            <span id="detailRegion" class="detail-value">New Brunswick</span>
                        </li>
                        <li>
                            <span class="detail-label">Time Zone</span>
                            <span id="detailTimeZone" class="detail-value">America/Halifax (ADT)</span>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div id="locationTab" class="tab-content">
                <div class="map-container" id="map">
                    <!-- Map will be loaded here -->
                    <img src="/api/placeholder/800/300" alt="Map location" style="width:100%; height:100%;">
                </div>
                
                <div class="detail-card">
                    <h3>Location Details</h3>
                    <table>
                        <tr>
                            <th>Detail</th>
                            <th>Value</th>
                        </tr>
                        <tr>
                            <td>Continent</td>
                            <td id="locationContinent">North America</td>
                        </tr>
                        <tr>
                            <td>Country</td>
                            <td id="locationCountry">Canada</td>
                        </tr>
                        <tr>
                            <td>Region</td>
                            <td id="locationRegion">New Brunswick</td>
                        </tr>
                        <tr>
                            <td>City</td>
                            <td id="locationCity">Saint John</td>
                        </tr>
                        <tr>
                            <td>Zip</td>
                            <td id="locationZip">E2J 4Y5</td>
                        </tr>
                        <tr>
                            <td>Coordinates</td>
                            <td id="locationCoordinates">45.2617301940918, -65.9207763671875</td>
                        </tr>
                        <tr>
                            <td>Time Zone</td>
                            <td id="locationTimeZone">America/Halifax</td>
                        </tr>
                        <tr>
                            <td>Currency</td>
                            <td id="locationCurrency">Canadian Dollar (CAD)</td>
                        </tr>
                    </table>
                </div>
            </div>
            
            <div id="rawTab" class="tab-content">
                <div class="detail-card">
                    <h3>Raw IP Data</h3>
                    <pre id="rawData" style="background: #f8f9fa; padding: 15px; overflow: auto; max-height: 400px; border-radius: 4px;">
{
  "ip": "174.113.207.105",
  "type": "ipv4",
  "continent_code": "NA",
  "continent_name": "North America",
  "country_code": "CA",
  "country_name": "Canada",
  "region_code": "NB",
  "region_name": "New Brunswick",
  "city": "Saint John",
  "zip": "E2J 4Y5",
  "latitude": 45.2617301940918,
  "longitude": -65.9207763671875,
  "location": {},
  "geoname_id": 6138517,
  "capital": "Ottawa",
  "languages": {
    "en": {
      "code": "en",
      "name": "English",
      "native": "English"
    },
    "fr": {
      "code": "fr",
      "name": "French",
      "native": "FranÃ§ais"
    }
  },
  "country_flag": "https://assets.ipstack.com/flags/ca.svg",
  "country_flag_emoji": "ðŸ‡¨ðŸ‡¦",
  "country_flag_emoji_unicode": "U+1F1E8 U+1F1E6",
  "calling_code": "1",
  "is_eu": false,
  "time_zone": {
    "id": "America/Halifax",
    "current_time": "2025-03-22T01:43:07-03:00",
    "gmt_offset": -10800,
    "code": "ADT",
    "is_daylight_saving": true
  },
  "currency": {
    "code": "CAD",
    "name": "Canadian Dollar",
    "plural": "Canadian dollars",
    "symbol": "CA$",
    "symbol_native": "$"
  },
  "connection": {
    "asn": 812,
    "isp": "Rogers Communications Canada Inc."
  },
  "security": {
    "is_proxy": false,
    "proxy_type": null,
    "is_crawler": false,
    "crawler_name": null,
    "crawler_type": null,
    "is_tor": false,
    "threat_level": "low",
    "threat_types": null
  }
}
                    </pre>
                </div>
                
                <div class="detail-card">
                    <h3>Analysis Result</h3>
                    <pre id="analysisResult" style="background: #f8f9fa; padding: 15px; overflow: auto; max-height: 400px; border-radius: 4px;">
{
  "ip": "174.113.207.105",
  "isProxy": false,
  "suspicionScore": 15,
  "confidence": 92,
  "signals": [
    {
      "isExplicitProxy": false,
      "proxyType": null,
      "isTor": false,
      "isCrawler": false,
      "threatLevel": "low",
      "threatTypes": null,
      "suspicious": false
    },
    {
      "fraudScore": 15,
      "isProxy": false,
      "isVpn": false,
      "isTor": false,
      "isBot": false,
      "isDatacenter": false,
      "isCloudProvider": false,
      "suspicious": false
    },
    {
      "asn": 812,
      "isp": "Rogers Communications Canada Inc.",
      "isKnownProxyAsn": false,
      "containsVpnKeyword": false,
      "suspicious": false
    },
    {
      "timeZoneMatchesRegion": true,
      "hasDetailedLocation": true,
      "suspicious": false
    },
    {
      "userAgentConsistent": true,
      "webRTCLeaks": false,
      "canvasFingerprint": true,
      "timeZoneOffset": true,
      "suspicious": false
    }
  ],
  "recommendedAction": "allow"
}
                    </pre>
                </div>
            </div>
        </section>
        
        <footer>
            <p>This tool uses multiple detection methods to identify proxies, VPNs, and anonymization services.</p>
        </footer>
    </div>
    
    <script>
        // Demo data for the IP address
        const ipData = {
            ip: "174.113.207.105",
            type: "ipv4",
            continent_code: "NA",
            continent_name: "North America",
            country_code: "CA",
            country_name: "Canada",
            region_code: "NB",
            region_name: "New Brunswick",
            city: "Saint John",
            zip: "E2J 4Y5",
            latitude: 45.2617301940918,
            longitude: -65.9207763671875,
            location: {},
            geoname_id: 6138517,
            capital: "Ottawa",
            languages: {
                en: {
                    code: "en",
                    name: "English",
                    native: "English"
                },
                fr: {
                    code: "fr",
                    name: "French",
                    native: "FranÃ§ais"
                }
            },
            country_flag: "https://assets.ipstack.com/flags/ca.svg",
            country_flag_emoji: "ðŸ‡¨ðŸ‡¦",
            country_flag_emoji_unicode: "U+1F1E8 U+1F1E6",
            calling_code: "1",
            is_eu: false,
            time_zone: {
                id: "America/Halifax",
                current_time: "2025-03-22T01:43:07-03:00",
                gmt_offset: -10800,
                code: "ADT",
                is_daylight_saving: true
            },
            currency: {
                code: "CAD",
                name: "Canadian Dollar",
                plural: "Canadian dollars",
                symbol: "CA$",
                symbol_native: "$"
            },
            connection: {
                asn: 812,
                isp: "Rogers Communications Canada Inc."
            },
            security: {
                is_proxy: false,
                proxy_type: null,
                is_crawler: false,
                crawler_name: null,
                crawler_type: null,
                is_tor: false,
                threat_level: "low",
                threat_types: null
            }
        };

        // Class to handle proxy/VPN detection
        class ProxyVPNDetector {
            constructor() {
                // This is just a demo implementation for display purposes
                this.knownProxyASNs = [14061, 16509, 14618, 15169, 3356, 9009, 4766, 9299, 6939];
                this.vpnKeywords = ['vpn', 'proxy', 'hosting', 'cloud', 'data center', 'server', 
                                   'anonymous', 'nord', 'express', 'hide', 'tor', 'exit'];
            }
            
            async analyzeIp(ipData) {
                // In a real implementation, this would make API calls
                // Here, we're just simulating the analysis for demonstration
                
                // Collect detection signals
                const signals = [
                    this.checkDirectSecurityFlags(ipData),
                    this.simulateIPReputationCheck(ipData),
                    this.analyzeAsnAndIsp(ipData),
                    this.checkGeographicConsistency(ipData),
                    this.simulateFingerprinting(ipData)
                ];
                
                // Calculate suspicion score
                const suspicionScore = this.calculateSuspicionScore(signals);
                
                // Determine if proxy based on score
                const isProxy = suspicionScore >= 65;
                
                return {
                    ip: ipData.ip,
                    isProxy,
                    suspicionScore,
                    confidence: this.calculateConfidence(signals),
                    signals,
                    recommendedAction: this.getRecommendedAction(suspicionScore)
                };
            }
            
            checkDirectSecurityFlags(ipData) {
                const security = ipData.security || {};
                
                return {
                    isExplicitProxy: security.is_proxy === true,
                    proxyType: security.proxy_type,
                    isTor: security.is_tor === true,
                    isCrawler: security.is_crawler === true,
                    threatLevel: security.threat_level,
                    threatTypes: security.threat_types,
                    suspicious: security.is_proxy === true || security.is_tor === true || security.threat_level !== "low"
                };
            }
            
            simulateIPReputationCheck(ipData) {
                // For demo purposes, we'll simulate a reputation check
                // In a real implementation, this would call an external API
                
                // Lower score for residential IPs, higher for known problematic ranges
                const fraudScore = 15;
                
                return {
                    fraudScore,
                    isProxy: false,
                    isVpn: false,
                    isTor: false,
                    isBot: false,
                    isDatacenter: false,
                    isCloudProvider: false,
                    suspicious: fraudScore > 75
                };
            }
            
            analyzeAsnAndIsp(ipData) {
                const connection = ipData.connection || {};
                const asn = connection.asn;
                const isp = connection.isp || '';
                
                const isKnownProxyAsn = this.knownProxyASNs.includes(asn);
                
                const ispLower = isp.toLowerCase();
                const containsVpnKeyword = this.vpnKeywords.some(keyword => 
                    ispLower.includes(keyword.toLowerCase())
                );
                
                return {
                    asn,
                    isp,
                    isKnownProxyAsn,
                    containsVpnKeyword,
                    suspicious: isKnownProxyAsn || containsVpnKeyword
                };
            }
            
            checkGeographicConsistency(ipData) {
                const timeZone = ipData.time_zone || {};
                const timeZoneId = timeZone.id || '';
                
                const tzRegion = timeZoneId.split('/')[0];
                const continentCode = ipData.continent_code;
                
                const timeZoneMatchesRegion = 
                    (tzRegion === 'America' && continentCode === 'NA') ||
                    (tzRegion === 'Europe' && continentCode === 'EU') ||
                    (tzRegion === 'Asia' && continentCode === 'AS') ||
                    (tzRegion === 'Africa' && continentCode === 'AF') ||
                    (tzRegion === 'Australia' && (continentCode === 'OC' || continentCode === 'AU')) ||
                    (tzRegion === 'Pacific' && continentCode === 'OC');
                
                const hasDetailedLocation = 
                    ipData.latitude && 
                    ipData.longitude && 
                    ipData.city && 
                    ipData.zip;
                
                return {
                    timeZoneMatchesRegion,
                    hasDetailedLocation,
                    suspicious: !timeZoneMatchesRegion || !hasDetailedLocation
                };
            }
            
            simulateFingerprinting() {
                // In a real implementation, this would use client-side fingerprinting
                return {
                    userAgentConsistent: true,
                    webRTCLeaks: false,
                    canvasFingerprint: true,
                    timeZoneOffset: true,
                    suspicious: false
                };
            }
            
            calculateSuspicionScore(signals) {
                // Example implementation to calculate suspicion score
                let score = 0;
                signals.forEach(signal => {
                    if (signal.suspicious) {
                        score += 20; // Add points for each suspicious signal
                    }
                });
                return Math.min(score, 100); // Cap the score at 100
            }
            }